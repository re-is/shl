//   Super HTA Library   |   Creator: István Reich   |   Build date: 2019.03.10
(function(){var sW=window,sD=window.document,sHun=false,sOffset=[0,0],sOuterSize=[0,0],sBorder=[0,0],sSet=false,sWndIsLoaded=false,sWndIsStarted=false,sTimerA=0,sTimerB=0,sTlast={className:''},sMsgLast=0,sMsgArray=[],sLogRows=1000,sLoglineText='',sLoglineEnabled=true,sHta,sSelectors={},sLastSelectorValue={},sDisabledSelector={},sActiveX={'fso':(new ActiveXObject('Scripting.FileSystemObject')),'wss':(new ActiveXObject('WScript.Shell')),'sap':(new ActiveXObject('Shell.Application'))};String.prototype.shlContains=function(r,s){var i=this.search(r);return((s===undefined)?(i>-1):(i==s))};Array.prototype.shlContains=function(v,s){var b=false;this.forEach(function(item,i){if((item===v)&&((s===undefined)?(i>-1):(i==s)))b=true});return b};function convertSize(s,dir){if(typeof s==='number')return s;if(!s.shlContains(/px|%|vh|vw/)){alert("'WND' .shlOpen() .shlSetSize() .shlSetOffset()\n\nWrong size parameters !\n\n•  '200px'\n•  '50%'\n•  '50vh'\n•  '50vw'\n");s='50%'};if(s.shlContains("px"))s=s.split("px")[0];else if(s.shlContains("%"))s=(sW.screen[dir]*(parseFloat(s.split("%")[0])/100));else if(s.shlContains("vw"))s=(sW.screen.width*(parseFloat(s.split("vw")[0])/100));else if(s.shlContains("vh"))s=(sW.screen.height*(parseFloat(s.split("vh")[0])/100));return parseInt(s)};function doOnFrame(func,frame){var i=-1;if(frame!==undefined){if(frame<0)frame=0;(function a(){if((i>-1)&&(frame==i)&&func(i))return;i++;sW.requestAnimationFrame(a)})()}else{(function b(){if((i>-1)&&(func(i)=="exit"))return;i++;sW.requestAnimationFrame(b)})()}};String.prototype.shlInfo=function(i){if(this!='HTA')return"";var info={'author':"István Reich",'created':"2017.Feb.15",'version':190301,'updated':"2019.Mar.10"};return info[i]};String.prototype.shlSleep=function(ms){if(this!='HTA')return;function tk(){'OBJ'.shlTaskkill(['powershell.exe','mshta.exe'])};sW.addEventListener("beforeunload",tk);sActiveX['wss'].Run('powershell.exe start-sleep -m '+ms+'"',0,true);sW.removeEventListener("beforeunload",tk)};String.prototype.shlActiveX=function(type){if(this=='HTA')return(sActiveX[type]?sActiveX[type]:alert("'HTA'.shlActiveX(type)\n\nWrong -type- parameter !\n\n•  'wss'\n•  'fso'\n•  'sap'\n"))};String.prototype.shlOn64bit=function(){if(this=='HTA')return(sActiveX['wss'].ExpandEnvironmentStrings('%PROCESSOR_ARCHITECTURE%').shlContains("64")||sActiveX['wss'].ExpandEnvironmentStrings('%PROCESSOR_ARCHITEW6432%').shlContains("64"))};String.prototype.shlPathName=function(m){if(this!='HTA')return"";if(!m.shlContains(/\b(file|folder|full)\b/)){alert("'HTA'.shlPathName()\n\nParameter is missing !\n\n•  'file'\n•  'folder'\n•  'full'\n");return""};var pn=sW.location.pathname,hta_file=pn.split("\\").pop();if(pn[0]=="/")pn=pn.substring(1,pn.length);if(m=='file')return hta_file;if(m=='folder')return pn.replace(hta_file,"");if(m=='full')return pn};String.prototype.shlFontSmoothing=function(bool){if(this!='HTA')return;var t=sD.getElementsByTagName('*');for(var i=0;i<t.length;i++){if(bool){if(t[i].tagName.shlContains(/BODY|INPUT|TEXTAREA/)&&t[i].currentStyle["text-shadow"]=="none")t[i].style.textShadow='0px 0px 1px #ccc';if(t[i].tagName.shlContains(/SCRIPT|BR|IMG|OBJECT|PARAM/)||(t[i].id&&t[i].id.shlContains(/shl-logline|shl-touch/)))t[i].style.textShadow=''}else if(t[i].currentStyle["text-shadow"]=="0px 0px 1px #ccc")t[i].style.textShadow=''}};String.prototype.shlEnv=function(pn){if(this!='HTA')return pn;var s=(pn.shlContains("%")?pn.split("%"):[]);if(s.length==3){s[1]=s[1].toLowerCase();if(s[1]=='desktop')s[1]=(sActiveX['wss'].ExpandEnvironmentStrings('%userprofile%')+'\\Desktop');else if((s[1]=='programfiles')&&'HTA'.shlOn64bit()){s[1]=sActiveX['wss'].ExpandEnvironmentStrings('%programfiles(x86)%');s[1]=s[1].slice(0,s[1].length-6)}else s[1]=sActiveX['wss'].ExpandEnvironmentStrings('%'+s[1]+'%');pn=s.join("")};try{sActiveX['fso'].GetFolder(pn);if(pn.substring(pn.length-1,pn.length)!="\\")pn+="\\"}catch(e){};return pn};String.prototype.shlRunReg=function(v,o){if(this!='HTA')return;var regFile='';try{regFile=sActiveX['fso'].GetFile(v)}catch(e){regFile='OBJ'.shlCreateFile('%temp%\\shl-TempRegFile.reg',v.replace(/\t/g,''),true,true)};(o?sActiveX['wss'].Run('notepad.exe "'+regFile+'"'):sActiveX['wss'].Run('cmd.exe /c regedit.exe /s "'+regFile+'"',0,true))};String.prototype.shlRunCmd=function(v,o){if(this!='HTA')return;var batFile='';try{batFile=sActiveX['fso'].GetFile(v)}catch(e){batFile='OBJ'.shlCreateFile('%temp%\\shl-TempBatFile.bat',v.replace(/\t/g,''),true)};(o?sActiveX['wss'].Run('notepad.exe "'+batFile+'"'):sActiveX['wss'].Run('cmd.exe /c "'+batFile+'"',0,true))};String.prototype.shlReadWebTextFile=function(link,func){if(this!='HTA')return;try{var xhr=new XMLHttpRequest();xhr.open('GET',(link+'?_='+new Date().getTime()));xhr.responseType='text';xhr.addEventListener("load",function(){if((xhr.readyState===xhr.DONE)&&(xhr.status===200))func(xhr.responseText)});xhr.send(null)}catch(e){'MSG'.shlOk("404: Not Found!")}};String.prototype.shlDownload=function(dl,tgt){if(this=='HTA')'HTA'.shlRunCmd('powershell -command (New-Object System.Net.WebClient).DownloadFile(\\"'+dl+'\\",\\"'+'HTA'.shlEnv(tgt)+'\\") && timeout /t 1')};String.prototype.shlUpdate=function(ver,link){if(this!='HTA')return[0,''];if(link)'HTA'.shlReadWebTextFile(link,function(text){var hta_path='HTA'.shlPathName('full'),lat=text.split('[SHL] - latest version: ')[1].split(';')[0],msg=text.split('[SHL] - notification message:\r\n')[1].split('\r\n[SHL] - end of message;')[0],ddl=text.split('[SHL] - direct download link: ')[1].split(';')[0],ext=text.split('[SHL] - downloaded file ext: ')[1].split(';')[0],web=text.split('[SHL] - open web page: ')[1].split(';')[0],opn=text.split('[SHL] - hta file re-open: ')[1].split(';')[0],txt=text.split('[SHL] - text of hta file:\r\n')[1].split('\r\n[SHL] - end of hta text;')[0];if(parseFloat(lat)<=ver)return;'MSG'.shlUpdateMsg(msg,function(){sD.body.innerHTML+='<div class="shl-html-tags" style="position:absolute;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,0.4);z-index:99999"></div>';if(ddl!=''){var dl_file='HTA'.shlEnv('%temp%\\shl-dl-file'+ext);'HTA'.shlDownload(ddl,dl_file);if('OBJ'.shlExists(dl_file))sActiveX['wss'].Run('"'+dl_file+'"',1,true);else'MSG'.shlOk(sHun?('A letöltés nem sikerült!'):('Download failed!'),false,'Ok')};if(web!='')sActiveX['wss'].Run('cmd.exe /c start "" "'+web+'"');if(opn=='true')sW.addEventListener('beforeunload',function(){sActiveX['wss'].Run('cmd.exe /c timeout /t 1 && start "" "'+hta_path+'"',0)});if(txt!='')'OBJ'.shlCreateFile(hta_path,txt,true);sW.close()},(sHun?'Igen':'Yes'),false,(sHun?'Később':'Later'),(link+'?_='+new Date().getTime()))});else link='';return[ver,link]};String.prototype.shlAddInputs=function(){if(this!='HTA')return;var forms=sD.getElementsByTagName('form'),labels=sD.getElementsByTagName('label');for(var i=0;i<labels.length;i++){if(labels[i].className.shlContains("shl-cb-labels")&&!labels[i].innerHTML.shlContains('<input type="checkbox"')){labels[i].innerHTML+='<input type="checkbox" class="shl-html-tags" id="shl-input-for-'+labels[i].id+'" style="display:none"'+(labels[i].className.shlContains(/\bchecked\b/)?' checked':'')+(labels[i].className.shlContains(/\bdisabled\b/)?' disabled':'')+'><span class="shl-cb shl-app-mode shl-html-tags"></span>'}};for(var i=0;i<forms.length;i++){var rlabels=forms[i].getElementsByTagName('label');for(var lab=0;lab<rlabels.length;lab++){if(rlabels[lab].className.shlContains("shl-rb-labels")&&!rlabels[lab].innerHTML.shlContains('<input type="radio"')){rlabels[lab].innerHTML+='<input type="radio" class="shl-html-tags" id="shl-input-for-'+rlabels[lab].id+'" name="'+forms[i].name+'" style="display:none"'+(rlabels[lab].className.shlContains(/\bchecked\b/)?' checked':'')+(rlabels[lab].className.shlContains(/\bdisabled\b/)?' disabled':'')+'><span class="shl-rb shl-app-mode shl-html-tags"></span>'}}}};String.prototype.shlAddItemsToSelector=function(selector,items,start){if(this!='HTA')return;var s=sD.getElementById(selector),list=sD.getElementById('shl-list-for-'+selector),input=sD.getElementById('shl-input-for-'+selector),i=-1,non=false;if(list==null)non=true;if(non){list=sD.createElement('div');list.id=('shl-list-for-'+selector);list.className='shl-selector-lists shl-app-mode shl-html-tags';list.style.border=(s.currentStyle["border-width"]+' '+s.currentStyle["border-style"]+' '+s.currentStyle["border-color"]);list.style.borderRadius=s.currentStyle["border-radius"];list.style.minWidth=(s.getBoundingClientRect().width+'px');input=sD.createElement('input');input.type='text';input.id=('shl-input-for-'+selector);input.className='shl-html-tags';input.style.position='absolute';input.style.top='0';input.style.marginTop='-100px'};list.innerHTML='';for(var value in items){i++;list.innerHTML+=('<div class="shl-list-items shl-app-mode shl-html-tags" id="'+selector+'-item-'+i+'">'+items[value]+'</div');if((start!==undefined)&&(start==i)){input.value=value;s.innerHTML=items[value]}};if(non){sD.body.appendChild(input);sD.body.appendChild(list)};sSelectors[selector]=items};String.prototype.shlHideSelectorLists=function(){if(this!='HTA')return[];var tags=sD.getElementsByTagName('div'),lists=[];for(var i=0;i<tags.length;i++){if(tags[i].id&&tags[i].id.shlContains('shl-list-for-')){lists.push(tags[i]);tags[i].style.display='none'}};return lists};function addObserver(){sW.addEventListener("mousedown",function(e){var lists='HTA'.shlHideSelectorLists(),list,list_rect;if(lists.length==0)return;if(e.target.className.shlContains('shl-selectors')&&!e.target.className.shlContains('disabled')){var selector_rect=e.target.getBoundingClientRect(),innerW=sW.innerWidth,innerH=sW.innerHeight;for(var i=0;i<lists.length;i++){list=lists[i];if(list.id.shlContains(e.target.id)){list.style.display='inline-block';list_rect=list.getBoundingClientRect();list.style.top=((((selector_rect.top+list_rect.height)>innerH)?(innerH-list_rect.height):selector_rect.top)+'px');list.style.left=((((selector_rect.left+list_rect.width)>innerW)?(innerW-list_rect.width):selector_rect.left)+'px')}}};if(e.target.className.shlContains('shl-list-items')){var selector=e.target.id.split('-item-')[0],items=sSelectors[selector],input=sD.getElementById('shl-input-for-'+selector);for(var value in items){if((items[value]==e.target.innerHTML)&&(input.value!=value)){input.focus();input.value=value;input.blur();input.onblur=function(ev){try{input.onchange(ev)}catch(err){}}}}}});(function inputObserver(){var inputs=sD.getElementsByTagName('input'),input,selector,s;for(var i=0;i<inputs.length;i++){input=inputs[i];if((input.type=='text')&&(input.id&&input.id.shlContains('shl-input-for-'))){selector=input.id.split('shl-input-for-')[1];s=sD.getElementById(selector);if(sLastSelectorValue[selector]!=input.value){s.innerHTML=sSelectors[selector][input.value];sLastSelectorValue[selector]=input.value};if(sDisabledSelector[selector]!=input.disabled){if(input.disabled){if(!s.className.shlContains(/\b disabled\b/))s.className+=' disabled'}else if(s.className.shlContains(/\b disabled\b/))s.className=s.className.replace(' disabled','');sDisabledSelector[selector]=input.disabled}}};sW.requestAnimationFrame(inputObserver)})()};function cookieExists(name){return(sD.cookie.shlContains(name+'='))};String.prototype.shlGet=function(name){if(this!='CKI')return;var ck=sD.cookie;return(ck.shlContains(name+'=')?ck.split(name+'=')[1].split(';')[0]:"")};String.prototype.shlSet=function(name,value,date){if(this!='CKI')return;if(!date)date='Thu, 01 Jan 2100 00:00:01 GMT';sD.cookie=name+'='+value+';expires='+date+';'};function cookieDel(name){if(sD.cookie.shlContains(name+'='))sD.cookie=name+'=;expires=Thu, 01 Jan 1970 00:00:00 GMT;'};String.prototype.shlDelAll=function(){if(this!='CKI')return;var c=sD.cookie.split(';');for(var i=0;i<c.length;i++)sD.cookie=c[i].split('=')[0]+'=;expires=Thu, 01 Jan 1970 00:00:00 GMT;'};String.prototype.shlOpen=function(wo){if(this!='WND')return;if(!sD.body){alert("'WND'.shlOpen( {} )\n\nUse this function in body / script tag !");return sW.close()};if(sSet)return alert("Use the 'WND'.shlOpen( {} )\n\nfunction only once !");sSet=true;if(typeof wo.title!=='string'){alert("'WND'.shlOpen( {} )\n\nThe - title: - parameter is missing !");return sW.close()};if(!wo.type||!wo.type.shlContains(/\b(tool|fixed|default|max|full)\b/)){alert("'WND'.shlOpen( {} )\n\nThe - type: - parameter is missing !\n\n•  'tool'\n•  'fixed'\n•  'default'\n•  'max'\n•  'full'\n");return sW.close()}else if(wo.type.shlContains(/tool|fixed|default/)){if(wo.caption===undefined){alert("'WND'.shlOpen( {} )\n\nThe - caption: - parameter is missing !\n\n•  true\n•  false\n•  'elem id'\n");return sW.close()}}else if((wo.caption!==undefined)||wo.width||wo.height||wo.left||wo.top){alert("'WND'.shlOpen( {} )\n\nIf the window type is 'max' or 'full' then\n\n•  caption:\n•  width:\n•  height:\n•  top:\n•  left:\n\nvalues are not required.\n")};if(wo.logline&&!wo.logline.shlContains(/\b(bottom|right)\b/)){alert("'WND'.shlOpen( {} )\n\nWrong - logline: - parameter !\n\n•  'bottom'\n•  'right'\n");return sW.close()};sHun=wo.hun;var wnd_title=((wo.title[0]=="!")?wo.title.substring(1,wo.title.length):wo.title);var title_tag=sD.getElementsByTagName('title')[0];(title_tag?(title_tag.innerHTML=wnd_title):sD.head.innerHTML+=('<title>'+wnd_title+'</title>'));if(typeof wo.caption==='string'){var cc=sD.getElementById(wo.caption);if(!cc){alert("'WND'.shlOpen( {} )\n\nNo such \"caption\" ID !");return sW.close()}else if(wo.title[0]!="!")cc.innerHTML=wnd_title};var html='<object class="shl-html-tags" id="shl-minimize-object" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11" style="display: none;"><param name="command" class="shl-html-tags" value="minimize"></object>';html+='<object class="shl-html-tags" id="shl-maximize-object" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11" style="display: none;"><param name="command" class="shl-html-tags" value="maximize"></object>';if(wo.logline)html+='<div class="shl-html-tags" id="shl-logline-panel"><textarea class="shl-html-tags" id="shl-logline-textarea" wrap="off" onclick="\'LOG\'.shl_pause();" oncontextmenu="return false;" onfocus="this.blur()" readonly></textarea><div class="shl-html-tags" id="shl-logline-paused">'+(sHun?'Szünet':'Pause')+'</div><div class="shl-html-tags" id="shl-logline-delete" onclick="\'LOG\'.shlDel();">'+(sHun?'Törlés':'Delete')+'</div></div>';if(wo.fadein)html+='<div class="shl-html-tags" id="shl-fadein-layer"></div>';html+='<div class="shl-html-tags" id="shl-msgbox-layer"><div class="shl-app-mode shl-html-tags" id="shl-msgbox-dialog"><textarea wrap="off" class="shl-app-mode shl-html-tags" id="shl-msgbox-textarea" onfocus="this.blur();" readonly></textarea><a href="#" class="shl-html-tags" id="shl-msgbox-update-link" target="_blank" style="display:none;font-size:16px;" onmouseover="this.style.color=\'#36f\'" onmouseout="this.style.color=\'#999\'">'+(sHun?'Részletek':'Details')+'</a><div class="shl-html-tags" id="shl-msgbox-buttons-block" style="display:inline-block;white-space:nowrap;"><div class="shl-msgbox-buttons shl-app-mode shl-html-tags" id="shl-msgbox-button-1"></div><div class="shl-msgbox-buttons shl-app-mode shl-html-tags" id="shl-msgbox-button-2"></div></div></div></div>';html+='<div class="shl-touch-box shl-html-tags" id="shl-touch-box-id"><div class="shl-touch-rect shl-touch-rect-fixed shl-html-tags" id="shl-touch-rect-id"><div class="shl-touch-circle shl-html-tags" id="shl-touch-circle-id"></div></div></div>';sD.body.innerHTML+=html;'HTA'.shlAddInputs();addObserver();var tags=sD.styleSheets,light=true;try{light=(sActiveX['wss'].RegRead('HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize\\AppsUseLightTheme')=='1')}catch(e){};if(wo.inverse)light=!light;for(var i=0;i<tags.length;i++){var css=tags[i].cssText;if(css.shlContains(/(\.shl-l-m|\.shl-d-m)\b/))tags[i].cssText=(light?css.replace(/\.shl-l-m\b/g,'.shl-app-mode'):css.replace(/\.shl-d-m\b/g,'.shl-app-mode'))};if(wo.type=="full")sOuterSize=[sW.screen.width,sW.screen.height];else if(wo.type=="max"){sBorder[0]=(sW.outerWidth-sW.innerWidth);sBorder[1]=(sW.outerHeight-sW.innerHeight);sOuterSize[0]=(sW.screen.availWidth+sBorder[0]);sOuterSize[1]=(sW.screen.availHeight+sBorder[1])}else if(wo.type.shlContains(/tool|fixed|default/)){if(wo.caption===true){sBorder[0]=(sW.outerWidth-sW.innerWidth);sBorder[1]=(sW.outerHeight-sW.innerHeight)};wo.width=convertSize(wo.width,"width");wo.height=convertSize(wo.height,"height");if(wo.width>sW.screen.width)wo.width=sW.screen.width;if(wo.height>sW.screen.height)wo.height=sW.screen.height;sOuterSize[0]=(wo.width+sBorder[0]);sOuterSize[1]=(wo.height+sBorder[1]);sOffset[0]=((wo.left!==undefined)?convertSize(wo.left,"width"):parseInt((sW.screen.width/2)-(sOuterSize[0]/2)));sOffset[1]=((wo.top!==undefined)?convertSize(wo.top,"height"):parseInt((sW.screen.height/2)-(sOuterSize[1]/2)))};if(wo.logline){var changed=false,llp=sD.getElementById('shl-logline-panel'),llt=sD.getElementById('shl-logline-textarea'),lld=sD.getElementById('shl-logline-delete');if(wo.logline=='bottom'){llp.style.width='100%';llp.style.height='30px';llp.style.bottom='0px';llp.style[(wo.caption===true)?'borderTop':'border']='3px solid #aaa'}else{llp.style.width='30px';llp.style.height='100%';llp.style.right='0px';llp.style[(wo.caption===true)?'borderLeft':'border']='3px solid #aaa'};sW.addEventListener("mousemove",function(e){if(capClick)return;if(e.target.id&&e.target.id.shlContains("shl-logline")){if(!changed){llp=sD.getElementById('shl-logline-panel');llt=sD.getElementById('shl-logline-textarea');lld=sD.getElementById('shl-logline-delete');llt.style.overflow='auto';lld.style.display='inline-block';setTimeout(function(){'LOG'.shl_log_del_btn()},15);changed=true};llp.style[(wo.logline=='bottom')?'height':'width']='calc(100% - 30px)'}else{llt.style.overflow='hidden';lld.style.display='none';llp.style[(wo.logline=='bottom')?'height':'width']='30px';changed=false}})};sHta=sD.createElement('HTA:APPLICATION');sHta.setAttribute('icon',(wo.icon?wo.icon:''));sHta.setAttribute('id','shl-app-id-'+wnd_title.replace(/\ /g,"-"));sHta.setAttribute('class','shl-html-tags');sHta.setAttribute('applicationname',wnd_title);sHta.setAttribute('singleinstance','yes');sHta.setAttribute('innerborder','no');sHta.setAttribute('scroll','no');sHta.setAttribute('selection','no');if(wo.type.shlContains(/max|full/))sHta.setAttribute('windowstate','maximize');else{if(wo.type.shlContains(/tool|fixed/))sHta.setAttribute('maximizebutton','no');if(wo.type=="tool")sHta.setAttribute('minimizebutton','no')};if(wo.type=='full'){sHta.setAttribute('caption','no');sHta.setAttribute('minimizebutton','no');sHta.setAttribute('maximizebutton','no')};if(wo.type!='max'){if(wo.caption!==true){sHta.setAttribute('caption','no');sHta.setAttribute('border','none')}else if(!wo.type.shlContains(/default|full/))sHta.setAttribute('border','thin')};sD.head.appendChild(sHta);var posX=0,posY=0,capClick=false;function starting(){sW.focus();sW.addEventListener("blur",function(){'HTA'.shlHideSelectorLists()});'HTA'.shlFontSmoothing((wo.fSmooth===undefined)?true:wo.fSmooth);if(wo.type.shlContains(/tool|fixed|default/)&&(typeof wo.caption==='string')){var capBg,capC,cap=sD.getElementById(wo.caption);cap.addEventListener("mouseup",function(){capClick=false});cap.addEventListener("mousedown",function(){capClick=true});sW.addEventListener("mousemove",function(e){if(capClick){sOffset[0]+=(e.pageX-posX);sOffset[1]+=(e.pageY-posY);sW.moveTo(sOffset[0],sOffset[1])}else{posX=e.pageX;posY=e.pageY}});sW.addEventListener("blur",function(){capBg=cap.currentStyle["background-color"];capC=cap.currentStyle["color"];cap.style.backgroundColor='#fff';cap.style.color='#aaa'});sW.addEventListener("focus",function(){cap.style.backgroundColor=capBg;cap.style.color=capC})};sD.body.addEventListener("mousedown",function(cursor){if((cursor.which!=1)||!cursor.target.className.shlContains('shl-touch-buttons'))return;var button=cursor.target,rect=button.getBoundingClientRect();if(!button.className.shlContains('shl-touch-effect')){sTlast.className=sTlast.className.replace(' shl-touch-effect','');button.className+=' shl-touch-effect'};sTlast=button;function changePseudo(attrs){var cssTag=sD.getElementById('shl-pseudo-style-tag'),html=cssTag.innerHTML,oldAttr=html.split('{')[1].split('}')[0],rows=oldAttr.split('\;'),i,aNameValue=[],newAttr='',name='',value='';for(i=0;i<rows.length;i++){aNameValue=rows[i].split('\:');for(var a in attrs){if(aNameValue[0]==a){name=a;value=attrs[a]}};newAttr+=(aNameValue[0]+'\:'+((name==aNameValue[0])?value:aNameValue[1])+((i<(rows.length-1))?'\;':''))};cssTag.innerHTML=html.replace(oldAttr,newAttr)};clearTimeout(sTimerA);var zf=0,dur=500;(function scaling(){if(zf==0)changePseudo({'transition-duration':'0ms','display':'inline-block','opacity':'1','width':'20px','height':'20px','top':parseInt(cursor.pageY-rect.top)+'px','left':parseInt(cursor.pageX-rect.left)+'px'});if(zf==1){changePseudo({'transition-duration':(dur+'ms'),'opacity':'0','width':'100px','height':'100px'});sTimerA=setTimeout(function(){changePseudo({'display':'none'});clearTimeout(sTimerA)},dur)};if(zf>1)return;zf++;sW.requestAnimationFrame(scaling)})();var clickAttr=button.getAttribute('onclick'),delay=(button.className.shlContains('shl-delay')?button.className.split('shl-delay-')[1].split('ms')[0]:'15');if(clickAttr!='')button.onclick=function(){button.setAttribute('onclick','');sTimerB=setTimeout(function(){button.setAttribute('onclick',clickAttr);button.onclick();clearTimeout(sTimerB)},parseInt(delay))}});if(wo.fadein){var op=1.0,fps=(1000/60),rate=(fps/wo.fadein[0]),delay=wo.fadein[1],fiLayer=sD.getElementById('shl-fadein-layer');doOnFrame(function(f){fiLayer.style.opacity=((op>0)?op:0);if((fps*f)<delay)return"";if(fiLayer.style.opacity>0){op-=rate;return""}else{fiLayer.style.display='none';sWndIsStarted=true;return"exit"}})}else doOnFrame(function(){sWndIsStarted=true},0)};var wnd_is_opened=false;if(wo.type.shlContains(/tool|fixed|default/)){if(wo.caption===true){sW.resizeTo(sOuterSize[0],sOuterSize[1]);sW.moveTo(sOffset[0],sOffset[1]);wnd_is_opened=true}else{sW.resizeTo(200,200);sW.moveTo(-300,-300);doOnFrame(function(frame){if(frame==20)sW.resizeTo(1,1);if(frame==40){sW.resizeTo(sOuterSize[0],sOuterSize[1]);sW.moveTo(sOffset[0],sOffset[1]);wnd_is_opened=true;return"exit"};return""})}}else wnd_is_opened=true;sW.addEventListener("load",function(){var f=0;doOnFrame(function(){if(wnd_is_opened)f++;if(f!=2)return"";starting();sWndIsLoaded=true;return"exit"})})};String.prototype.shlOnLoad=function(func){if(this!='WND')return;doOnFrame(function(){if(sWndIsLoaded){func();return"exit"};return""})};String.prototype.shlOnStart=function(func){if(this!='WND')return;doOnFrame(function(){if(sWndIsStarted){func();return"exit"};return""})};String.prototype.shlOnFrame=function(func,fl){if(this!='WND')return;var f=0,en=((fl===undefined)?false:fl);doOnFrame(function(){if((en&&sWndIsLoaded)||sWndIsStarted){func(f);f++};return""})};String.prototype.shlOnTick=function(func,fl){if(this!='WND')return;var t=0,en=((fl===undefined)?false:fl);setInterval(function(){if((en&&sWndIsLoaded)||sWndIsStarted){func(t);t++}},15)};String.prototype.shlGetOffset=function(){if(this!='WND')return;sOffset=[sW.screenX,sW.screenY];return sOffset.slice()};String.prototype.shlSetOffset=function(x,y){if(this!='WND')return;if(arguments.length==0){x=((sW.screen.width/2)-(sW.outerWidth/2));y=((sW.screen.height/2)-(sW.outerHeight/2))}else if(typeof x==='object'){y=(x[1]?x[1]:0);x=(x[0]?x[0]:0)}else if(!y)y='0px';x=convertSize(x,"width");y=convertSize(y,"height");sOffset[0]=parseInt(x);sOffset[1]=parseInt(y);sW.moveTo(sOffset[0],sOffset[1])};String.prototype.shlGetSize=function(){if(this!='WND')return;var s=sOuterSize;s[0]-=sBorder[0];s[1]-=sBorder[1];return s.slice()};String.prototype.shlSetSize=function(x,y,c){if(this!='WND')return;if(arguments.length==0)return alert("'WND'.shlSetSize()\n\nParameter is missing !\n\n•  array | number");if(typeof x==='object'){y=(x[1]?x[1]:0);x=(x[0]?x[0]:0)}else if(!y)y='0px';x=convertSize(x,"width");y=convertSize(y,"height");if(x>sW.screen.width)x=sW.screen.width;if(y>sW.screen.height)y=sW.screen.height;x+=sBorder[0];y+=sBorder[1];sOuterSize[0]=parseInt(x);sOuterSize[1]=parseInt(y);sW.resizeTo(sOuterSize[0],sOuterSize[1]);if((c===undefined)?true:c)this.shlSetOffset()};String.prototype.shlBorder=function(v){if(this=='WND')return(v?((v=='lrb')?(sBorder[0]/2):((v=='top')?(sBorder[1]-(sBorder[0]/2)):0)):sBorder.slice())};String.prototype.shlCmd=function(cmd){if(this!='WND')return;if((!cmd)||!cmd.shlContains(/\b(min|max|close)\b/))return alert("'WND'.shlCmd(cmd)\n\nThe - cmd - parameter is missing !\n\n•  'min'\n•  'max'\n•  'close'\n");if((cmd=='min')&&(sHta.getAttribute('minimizebutton')!="no"))sD.getElementById('shl-minimize-object').Click();if((cmd=='max')&&(sHta.getAttribute('maximizebutton')!="no"))sD.getElementById('shl-maximize-object').Click();if(cmd=='close')sW.close()};String.prototype.shlDpiFactor=function(){if(this!='WND')return;var dpi=1.0;try{dpi=(parseInt(sActiveX['wss'].RegRead('HKCU\\Control Panel\\Desktop\\LogPixels'))/96)}catch(e){};return dpi};function showMsg(type,text,func1,b1,func2,b2,link){if(!sWndIsStarted){setTimeout(function(){showMsg(type,text,func1,b1,func2,b2,link)},15);return};sMsgArray.push([type,text,func1,b1,func2,b2,link]);readArray()};function readArray(){var msgLayer=sD.getElementById('shl-msgbox-layer');if(msgLayer.style.display=='block')return;if(sMsgLast<sMsgArray.length){msgLayer.style.display='block';var box=sMsgArray[sMsgLast];var dialog=sD.getElementById('shl-msgbox-dialog'),tarea=sD.getElementById('shl-msgbox-textarea'),msgLink=sD.getElementById('shl-\msgb\ox-upd\ate-lin\k'),bBlock=sD.getElementById('shl-msgbox-buttons-block'),btn1=sD.getElementById('shl-msgbox-button-1'),btn2=sD.getElementById('shl-msgbox-button-2');function hide(b){msgLayer.style.display='none';msgLink.style.display='none';if(b&&box[2])box[2]();if(!b&&box[4])box[4]();readArray()};btn1.style.display='none';btn2.style.display='none';btn1.innerHTML=(box[3]?box[3]:((box[0]=='ok')?'Ok':(sHun?'Igen':'Yes')));btn1.style.display='inline-block';btn1.onclick=function(){hide(true)};if(box[0]=='confirm'){btn2.innerHTML=(box[5]?box[5]:(sHun?'Mégse':'Cancel'));btn2.style.display='inline-block';btn2.onclick=function(){hide()};if(box[6]){msgLink.style.display='inline-block';msgLink.style.visibility='visible';msgLink.style.opacity='1';msgLink.style.color='#999';msgLink.href=box[6]}};tarea.setAttribute("wrap","off");tarea.style.height='';dialog.style.width='';dialog.style.marginTop='';dialog.style.marginLeft='';tarea.value=new String(box[1]);var block_width=bBlock.offsetWidth,innerw=sW.innerWidth,innerh=sW.innerHeight,dialog_max=(innerw*0.95);dialog.style.width='0px';dialog_max-=dialog.offsetWidth;var tarea_width=((tarea.offsetWidth-tarea.clientWidth)+tarea.scrollWidth),dialog_width=((block_width>tarea_width)?block_width:tarea_width);dialog.style.width=((dialog_width<dialog_max)?dialog_width:dialog_max)+'px';if(dialog_width>=dialog_max)tarea.setAttribute("wrap","on");var tarea_height=(dialog.offsetHeight-tarea.offsetHeight),tarea_max=((innerh*0.95)-tarea_height);tarea.style.height=((tarea.scrollHeight<tarea_max)?tarea.scrollHeight:tarea_max)+'px';dialog.style.marginTop=((innerh*0.5)-(dialog.offsetHeight*0.5))+'px';dialog.style.marginLeft=((innerw*0.5)-(dialog.offsetWidth*0.5))+'px';sMsgArray[sMsgLast]=false;sMsgLast++}};String.prototype.shlOk=function(t,f,b){if(this=='MSG')showMsg('ok',t,f,b)};String.prototype.shlConfirm=function(t,f1,b1,f2,b2){if(this=='MSG')showMsg('confirm',t,f1,b1,f2,b2)};String.prototype.shlUpdateMsg=function(t,f1,b1,f2,b2,link){if(this=='MSG')showMsg('confirm',t,f1,b1,f2,b2,link)};function objectExists(pn){pn='HTA'.shlEnv(pn);return(sActiveX['fso'].FileExists(pn)||sActiveX['fso'].FolderExists(pn))};function objectOperation(op){if(!op||!op.cmd||!op.cmd.shlContains(/\b(copy|move|del|rename|visibility)\b/))return alert("objectOperation( {} )\n\nThe - cmd: - parameter is missing !\n\n•  'copy'\n•  'move'\n•  'del'\n•  'rename'\n•  'visibility'\n\n");var cmd_capitalized=(op.cmd[0].toUpperCase()+op.cmd.substring(1,op.cmd.length));var a="'OBJ'.shl"+cmd_capitalized+"(";if(op.source===undefined)return alert(a+"source, ...)\n\nThe - source - parameter is missing !\n");if(op.cmd.shlContains(/copy|move/)){if(op.overwrite===undefined)op.overwrite=true;if(op.target){var t_folder='HTA'.shlEnv(op.target);if(!sActiveX['fso'].FolderExists(t_folder))return alert(a+"source, target, overwrite)\n\nNo such target folder !\n\n"+op.target)}else return alert(a+"source, target, overwrite)\n\nThe - target - parameter is missing !\n")}else{if(op.target)return alert(a+"source, target, overwrite)\n\nExcept for copy and move,\n\nyou don't need the - target - parameter.\n");if(op.overwrite)return alert(a+"source, target, overwrite)\n\nExcept for copy and move,\n\nyou don't need the - overwrite - parameter.\n")};if(op.cmd=='rename'){if(typeof op.newname!=='string')return alert(a+"source, newname)\n\nThe - newname - parameter is missing !\n")}else if(op.newname)return alert(a+"source, newname)\n\nExcept for rename,\n\nyou don't need the - newname - parameter.\n");if(op.cmd=='visibility'){if(typeof op.visible!=='boolean')return alert(a+"source, visible)\n\nThe - visible - parameter is missing !\n\n•  true-false\n")}else if(op.visible)return alert(a+"source, visible)\n\nExcept for visibility,\n\nyou don't need the - visible - parameter.\n");function operat(s_object){var file=false;s_object='HTA'.shlEnv(s_object);if(objectExists(s_object)){try{s_object=sActiveX['fso'].GetFile(s_object);file=true}catch(e){s_object=sActiveX['fso'].GetFolder(s_object)};s_object=new String(s_object);if(op.cmd.shlContains(/copy|move/)){var t_object=t_folder+s_object.split("\\").pop();if(op.overwrite&&objectExists(t_object)){(file?sActiveX['fso'].DeleteFile(t_object):sActiveX['fso'].DeleteFolder(t_object))};if(!objectExists(t_object)){if(file){if(op.cmd=='copy')sActiveX['fso'].CopyFile(s_object,t_folder,true);if(op.cmd=='move')sActiveX['fso'].MoveFile(s_object,t_folder)}else{if(op.cmd=='copy')sActiveX['fso'].CopyFolder(s_object,t_folder,true);if(op.cmd=='move')sActiveX['fso'].MoveFolder(s_object,t_folder)}}};if(op.cmd=='del'){(file?sActiveX['fso'].DeleteFile(s_object):sActiveX['fso'].DeleteFolder(s_object))};if(op.cmd=='rename'){var s_folder=s_object.replace(s_object.split("\\").pop(),"");(file?sActiveX['fso'].MoveFile(s_object,s_folder+op.newname):sActiveX['fso'].MoveFolder(s_object,s_folder+op.newname))};if(op.cmd=='visibility'){(file?(sActiveX['fso'].GetFile(s_object).Attributes=(op.visible?0:2)):(sActiveX['fso'].GetFolder(s_object).Attributes=(op.visible?16:18)))}}};if(typeof op.source==='object'){if(op.cmd=='rename')return alert(a+")\n\nOnly one object can be renamed !");else for(var i=0;i<op.source.length;i++)operat(op.source[i])}else if(typeof op.source==='string')operat(op.source);else return alert("'OBJ'.shl"+cmd_capitalized+"()\n\nThe - source - parameter is missing !\n\n•  'pathname'\n•  ['pathname 1', 'pathname 2']")};String.prototype.shlCopy=function(src,tgt,ow){if(this=='OBJ')objectOperation({cmd:'copy',source:src,target:tgt,overwrite:ow})};String.prototype.shlMove=function(src,tgt,ow){if(this=='OBJ')objectOperation({cmd:'move',source:src,target:tgt,overwrite:ow})};function objectDel(src){objectOperation({cmd:'del',source:src})};String.prototype.shlRename=function(src,nn){if(this=='OBJ')objectOperation({cmd:'rename',source:src,newname:nn})};String.prototype.shlVisibility=function(src,st){if(this=='OBJ')objectOperation({cmd:'visibility',source:src,visible:st})};String.prototype.shlCreateFile=function(pn,text,ow,uc){if(this!='OBJ')return;pn='HTA'.shlEnv(pn);if(sActiveX['fso'].FileExists(pn)&&((ow===undefined)?true:ow))sActiveX['fso'].DeleteFile(pn);if(!sActiveX['fso'].FileExists(pn)){var tf=sActiveX['fso'].CreateTextFile(pn,true,true);tf.WriteLine(text);tf.Close();if((uc===undefined)?true:!uc){sActiveX['wss'].Run('cmd.exe /c chcp 65001 & cmd.exe /c type "'+pn+'" > "'+pn+'.txt"',0,true);sActiveX['fso'].DeleteFile(pn);sActiveX['fso'].MoveFile(pn+".txt",pn)}};return(new String(sActiveX['fso'].GetFile(pn)))};String.prototype.shlCreateFolder=function(pn,ow){if(this!='OBJ')return;pn='HTA'.shlEnv(pn);if(pn[pn.length-1]=='\\')pn=pn.substring(0,pn.length-1);if(sActiveX['fso'].FolderExists(pn)&&((ow===undefined)?true:ow))sActiveX['fso'].DeleteFolder(pn);if(!sActiveX['fso'].FolderExists(pn))sActiveX['fso'].CreateFolder(pn);return(new String(sActiveX['fso'].GetFolder(pn))+'\\')};String.prototype.shlTaskkill=function(file){if(this!='OBJ')return;if(typeof file==='string')sActiveX['wss'].Run('cmd.exe /c taskkill /f /im "'+file+'"',0,true);else for(var i=0;i<file.length;i++)sActiveX['wss'].Run('cmd.exe /c taskkill /f /im "'+file[i]+'"',0,true)};function readInUnicode(pn){sActiveX['wss'].Run('cmd.exe /c chcp 65001 & cmd.exe /u /c type "'+pn+'" > "'+pn+'.uni"',0,true);var unicode_file=sActiveX['fso'].OpenTextFile(pn+'.uni',1,0,-1);var text=unicode_file.ReadAll();unicode_file.Close();sActiveX['fso'].DeleteFile(pn+'.uni');return text};String.prototype.shlGetDetail=function(pn,after,before){if(this!='TXT')return;pn='HTA'.shlEnv(pn);if(!objectExists(pn)){alert("No such file !\n\n"+pn);return""};if(!after)after="\r\n";if(!before)before="\r\n";var all_text=readInUnicode(pn);return(all_text.shlContains(after)?all_text.split(after)[1].split(before)[0]:"")};String.prototype.shlSetDetail=function(pn,after,before,new_detail){if(this!='TXT')return;pn='HTA'.shlEnv(pn);if(!objectExists(pn))return alert("No such file !\n\n"+pn);if(!before)before="\r\n";var all_text=readInUnicode(pn);if(all_text.shlContains(after)){var old_detail=all_text.split(after)[1].split(before)[0];var tf=sActiveX['fso'].CreateTextFile(pn,true,true);all_text=all_text.replace(after+old_detail,after+(new_detail?new_detail:""));var rows=all_text.split("\r\n");if(rows[rows.length-1]=="")all_text=rows.slice(0,rows.length-1).join("\r\n");tf.WriteLine(all_text);tf.Close();sActiveX['wss'].Run('cmd.exe /c chcp 65001 & cmd.exe /c type "'+pn+'" > "'+pn+'.utf"',0,true);sActiveX['fso'].DeleteFile(pn);sActiveX['fso'].MoveFile(pn+".utf",pn)}};String.prototype.shlFullText=function(pn){if(this!='TXT')return;pn='HTA'.shlEnv(pn);if(!objectExists(pn)){alert("No such file !\n\n"+pn);return""};return readInUnicode(pn)};var t=false;String.prototype.shl_log_del_btn=function(){if(this!='LOG')return;var ta=sD.getElementById('shl-logline-textarea'),de=sD.getElementById('shl-logline-delete');de.style.right=((ta.offsetWidth-ta.clientWidth)+3)+'px';de.style.bottom=((ta.offsetHeight-ta.clientHeight)+3)+'px'};String.prototype.shl_pause=function(){if(this!='LOG')return;sD.getElementById('shl-logline-paused').style.display=(sLoglineEnabled?'inline-block':'none');sLoglineEnabled=!sLoglineEnabled};String.prototype.shlMaxRows=function(row){if(this=='LOG')sLogRows=parseInt(row)};String.prototype.shlAdd=function(text){if(this!='LOG')return;if(arguments.length>0){sLoglineText+=(new String(text)+"\n");if(sLoglineEnabled&&!t)t=setTimeout(function(){var ta=sD.getElementById('shl-logline-textarea'),txt="",arr=[];if(!ta)return;txt=sLoglineText.replace(/\t/g,"   ");arr=txt.split("\n");ta.value=((arr.length>sLogRows)?arr.slice(arr.length-(sLogRows+1),arr.length).join("\n"):txt);ta.scrollTop=ta.scrollHeight;'LOG'.shl_log_del_btn();t=false},15)};return sLoglineText};function loglineDel(){sLoglineText='';sD.getElementById('shl-logline-textarea').value=sLoglineText;'LOG'.shl_log_del_btn()};String.prototype.shlElem=function(val){if(this=='id')return sD.getElementById(val);if(this=='input')return sD.getElementById('shl-input-for-'+val);var e=[],tags=sD.getElementsByTagName('*');if(this=='class'){for(var i=0;i<tags.length;i++){if(tags[i].className.shlContains(new RegExp("\\b"+val+"\\b")))e.push(tags[i])};return e};if(this=='tag'){for(var i=0;i<tags.length;i++){if(!tags[i].className.shlContains('shl-html-tags')){if(val=='*')e.push(tags[i]);else if(val.toUpperCase()==tags[i].tagName)e.push(tags[i])}};return e};return tags};String.prototype.shlDel=function(val){if(this=='CKI')return cookieDel(val);if(this=='OBJ')return objectDel(val);if(this=='LOG')return loglineDel()};String.prototype.shlExists=function(val){if(this=='CKI')return cookieExists(val);if(this=='OBJ')return objectExists(val)};if('HTA'.shlOn64bit()&&'OBJ'.shlExists('%SystemRoot%\\Sysnative\\cmd.exe')){String.prototype.shlOpen=function(w){};sW.resizeTo(100,100);sW.moveTo(-300,-300);sActiveX['wss'].Run('%SystemRoot%\\Sysnative\\cmd.exe /c timeout /t 1 && start "%SystemRoot%\\System32\\mshta.exe" "'+'HTA'.shlPathName('full')+'"',0);if(!sActiveX['wss'].RegRead('HKCR\\htafile\\Shell\\Open\\Command\\').shlContains('System32')){var mshta='HTA'.shlEnv('%SystemRoot%\\System32\\mshta.exe').replace(/\\/g,'\\\\'),regFile='OBJ'.shlCreateFile('%temp%\\shl-TempRegFile.reg','Windows Registry Editor Version 5.00\r\n\r\n[HKEY_CLASSES_ROOT\\htafile\\Shell\\Open\\Command]\r\n@="'+mshta+' \\"%1\\""',true,true);sActiveX['wss'].Run('%SystemRoot%\\Sysnative\\cmd.exe /c regedit.exe /s "'+regFile+'"',0)};sW.close()};sW.addEventListener("keydown",function(e){if(e.keyCode==112)'MSG'.shlOk((sHun?"Shl legutóbbi frissítése:\n":"Shl latest update:\n")+'HTA'.shlInfo('updated')+"\n\n"+(sHun?"Verzió:\n":"Version:\n")+'HTA'.shlInfo('version'))});sD.write('<link rel="stylesheet" type="text/css" href="https://rawgit.com/re-is/shl/master/shl.'+'HTA'.shlInfo('version')+'.css?_='+(new Date().getTime())+'" class="shl-html-tags"></link>');sD.write('<style type="text/css" id="shl-pseudo-style-tag" class="shl-html-tags">.shl-touch-effect::before{position:absolute;content:"";display:none;width:0;height:0;top:0;left:0;opacity:1;border-radius:50%;transform:translate(-50%,-50%);transition-property:width, height, opacity;transition-duration:0ms;z-index:9999}</style>')})();
