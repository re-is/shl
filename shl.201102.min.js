//   Super HTA Library   |   Creator: István Reich   |   Build date: 2020.11.20
(function(_Win,_Doc){let _Offset=[0,0],_OuterSize=[0,0],_Border=[0,0],_Opened=false,_IsOpen=false,_IsLoaded=false,_IsReady=false,_TimerA=-1,_TimerB=-1,_TimerC=-1,_LastBtn={className:''},_LastMsg=0,_MsgArray=[],_LogRows=0,_LoglineText='',_LoglineEnabled=true,_CaptionClicked=false,_Selectors={},_PowerTime={},_MPowerTime=(new Date().getTime()),_Fso=(new ActiveXObject('Scripting.FileSystemObject')),_Wss=(new ActiveXObject('WScript.Shell')),_Sap=(new ActiveXObject('Shell.Application')),_HTAtag=_Doc.createElement('HTA:APPLICATION'),_Hun=function(){let h;try{h=(_Wss['RegRead']('HKLM\\SYSTEM\\ControlSet001\\Control\\Nls\\Language\\InstallLanguage').toLowerCase()==='040e')}catch(e){h=false};return h}(),_LoopIn=function(obj,func){let key,index=0;for(key in obj){if(!obj.hasOwnProperty(key))continue;if(func(key,obj[key],index))break;index++}},_LoopPlus=function(length,func){for(let index=0;index<length;index++)if(func(index))break},_LoopMinus=function(length,func){for(let index=(length-1);index>=0;index--)if(func(index))break},_Find=function(srch,find){if(typeof srch==='object'){let b=false;_LoopIn(srch,function(key,value){if(value===find)b=true});return b}else return(String(srch).search(find)>-1)},_Class=function(name){return _Doc.getElementsByClassName(String(name))[0]},_ClassGet=function(elem,v){let e=(_Doc.getElementsByClassName(String(elem))[0]||elem);return(e&&_Find(e.className,v))},_ClassSet=function(elem,v,b){let e=(_Doc.getElementsByClassName(String(elem))[0]||elem);if(e){if(_Find(e.className,v)&&!b)e.className=e.className.replace(new RegExp(' '+v+'\\b'),'');if(!_Find(e.className,v)&&b)e.className+=(' '+v)}},_ConvertSize=function(s,dir){if(s===undefined)s=0;if(typeof s==='number')return s;if(!_Find(s,/px|%|vh|vw/)){_Win.alert(".wnd .open() .setSize() .setOffset()\n\nWrong size parameters !\n\n•  '200px'\n•  '50%'\n•  '50vh'\n•  '50vw'\n");s='50%'};if(_Find(s,'px'))s=s.split('px')[0];else if(_Find(s,'%'))s=(_Win.screen[dir]*(parseFloat(s.split('%')[0])/100));else if(_Find(s,'vw'))s=(_Win.screen.width*(parseFloat(s.split('vw')[0])/100));else if(_Find(s,'vh'))s=(_Win.screen.height*(parseFloat(s.split('vh')[0])/100));return Math.ceil(s)},_DoOnFrame=function(func,frame){let i=-1;if(frame!==undefined){if(frame<0)frame=0;(function a(){if((i>-1)&&(frame===i)){func(i);return null};i++;_Win.requestAnimationFrame(a)})()}else{(function b(){if((i>-1)&&func(i))return null;i++;_Win.requestAnimationFrame(b)})()}},_X64=function(){function envr(s){return _Wss['ExpandEnvironmentStrings'](s)};return _Find(envr('%PROCESSOR_ARCHITECTURE%')+' '+envr('%PROCESSOR_ARCHITEW6432%'),'64')},_HideSelectorLists=function(){let tags=_Doc.getElementsByClassName('shl-selector-lists'),selectorId='',listObject={};_LoopIn(tags,function(key,tag){selectorId=tag.className.split('shl-list-for-')[1];listObject[selectorId]=tag;tag.style.display='none'});return listObject},_AddObservers=function(){_Win.addEventListener('mousedown',function(e){let target=e.target,listObject=_HideSelectorLists(),listTag=listObject[target.id];if(_ClassGet(target,'shl-selectors')&&!_ClassGet(target,'disabled')){if(!listTag){_Win.alert("Not found values for '"+target.id+"' selector !");return null};let selector_rect=target.getBoundingClientRect(),list_rect=listTag.getBoundingClientRect(),innerW=_Win.innerWidth,innerH=_Win.innerHeight;listTag.style.display='inline-block';listTag.style.top=((((selector_rect.top+list_rect.height)>innerH)?(innerH-list_rect.height):selector_rect.top)+'px');listTag.style.left=((((selector_rect.left+list_rect.width)>innerW)?(innerW-list_rect.width):selector_rect.left)+'px')};if(_ClassGet(target,'shl-list-items')){let selector=target.id.split('-item-')[0],items=_Selectors[selector],input=_Class('shl-input-for-'+selector);_LoopIn(items,function(key,itemText){if((itemText===target.innerText)&&(input.value!==key))input.value=key})}});(function observer(){let inputs=_Doc.getElementsByClassName('shl-inputs'),selector,s,val;_LoopIn(inputs,function(key,input){selector=input.className.split('shl-input-for-')[1];s=_Doc.getElementById(selector);val=_Selectors[selector][input.value];if(s.innerText!==val)s.innerText=val;if(_ClassGet(s,'disabled')!==input.disabled)_ClassSet(s,'disabled',input.disabled)});_Win.requestAnimationFrame(observer)})();_Win.addEventListener('DOMNodeInserted',function(){if(_TimerC===-1)_TimerC=_Win.requestAnimationFrame(function(){let forms=_Doc.getElementsByTagName('form'),cb_labels=_Doc.getElementsByClassName('shl-cb-labels');_LoopIn(cb_labels,function(i,label){if(!label.id){_Win.alert("Not found id for '"+label.innerText+"' !");return null};if(_Find(label.innerHTML,'<input type="checkbox"'))return null;label.innerHTML+=('<input type="checkbox" class="shl-html-tags shl-input-for-'+label.id+'" style="display:none"'+(_ClassGet(label,'checked')?' checked':'')+(_ClassGet(label,'disabled')?' disabled':'')+'><span class="shl-cb shl-app-mode shl-html-tags"></span>')});_LoopIn(forms,function(key,form){if(!form.name){_Win.alert("Not found 'name' attribute for 'form' tag !");return null};let rb_labels=form.getElementsByClassName('shl-rb-labels');_LoopIn(rb_labels,function(key,label){if(!label.id){_Win.alert("Not found id for '"+label.innerText+"' !");return null};if(_Find(label.innerHTML,'<input type="radio"'))return null;label.innerHTML+=('<input type="radio" class="shl-html-tags shl-input-for-'+label.id+'" name="'+form.name+'" style="display:none"'+(_ClassGet(label,'checked')?' checked':'')+(_ClassGet(label,'disabled')?' disabled':'')+'><span class="shl-rb shl-app-mode shl-html-tags"></span>')})});_TimerC=-1})})},_ReadArray=function(){let msgLayer=_Class('shl-msgbox-layer');if(msgLayer.style.display==='block')return;if(_LastMsg<_MsgArray.length){msgLayer.style.display='block';let box=_MsgArray[_LastMsg];let dialog=_Class('shl-msgbox-dialog'),tarea=_Class('shl-msgbox-textarea'),msgLink=_Class('shl-\msgb\ox-upd\ate-lin\k'),bBlock=_Class('shl-msgbox-buttons-block'),btn1=_Class('shl-msgbox-button-1'),btn2=_Class('shl-msgbox-button-2');function hide(b){msgLayer.style.display='none';msgLink.style.display='none';if(b&&box[2])box[2]();if(!b&&box[4])box[4]();_ReadArray()};btn1.style.display='none';btn2.style.display='none';btn1.innerHTML=(box[3]?box[3]:((box[0]==='ok')?'Ok':(_Hun?'Igen':'Yes')));btn1.style.display='inline-block';btn1.onclick=function(){hide(true)};if(box[0]==='confirm'){btn2.innerHTML=(box[5]?box[5]:(_Hun?'Mégse':'Cancel'));btn2.style.display='inline-block';btn2.onclick=function(){hide()};if(box[6]){msgLink.style.display='inline-block';msgLink.style.visibility='visible';msgLink.style.opacity='1';msgLink.style.color='#999';msgLink.href=box[6]}};tarea.setAttribute('wrap','off');tarea.style.height='';dialog.style.width='';dialog.style.marginTop='';dialog.style.marginLeft='';tarea.value=String(box[1]);let block_width=bBlock.offsetWidth,innerw=_Win.innerWidth,innerh=_Win.innerHeight;let dialog_max=(innerw*0.95);dialog.style.width='0px';dialog_max-=dialog.offsetWidth;let tarea_width=((tarea.offsetWidth-tarea.clientWidth)+tarea.scrollWidth),dialog_width=((block_width>tarea_width)?block_width:tarea_width);dialog.style.width=((dialog_width<dialog_max)?dialog_width:dialog_max)+'px';if(dialog_width>=dialog_max)tarea.setAttribute('wrap','on');let tarea_height=(dialog.offsetHeight-tarea.offsetHeight),tarea_max=((innerh*0.95)-tarea_height);tarea.style.height=((tarea.scrollHeight<tarea_max)?tarea.scrollHeight:tarea_max)+'px';dialog.style.marginTop=((innerh*0.5)-(dialog.offsetHeight*0.5))+'px';dialog.style.marginLeft=((innerw*0.5)-(dialog.offsetWidth*0.5))+'px';_MsgArray[_LastMsg]=false;_LastMsg++}},_ShowMsg=function(type,text,func1,b1,func2,b2,link){if(!_IsReady){setTimeout(function(){_ShowMsg(type,text,func1,b1,func2,b2,link)},15);return};_MsgArray.push([type,text,func1,b1,func2,b2,link]);_ReadArray()},_OkMsg=function(t,f,b){_ShowMsg('ok',t,f,b)},_ConfirmMsg=function(t,f1,b1,f2,b2){_ShowMsg('confirm',t,f1,b1,f2,b2)},_TaskKill=function(file){if(typeof file==='string')_Wss['Run']('cmd.exe /c taskkill /f /im "'+file+'"',0,true);else _LoopIn(file,function(key,f_le){_Wss['Run']('cmd.exe /c taskkill /f /im "'+f_le+'"',0,true)})},_Env=function(pn){let s=(_Find(pn,'%')?pn.split('%'):[]);if(s.length===3){s[1]=s[1].toLowerCase();if(!_X64()&&_Find(s[1],'(x86)'))s[1]=s[1].substring(0,s[1].length-5);if(s[1]==='desktop')s[1]=(_Wss['ExpandEnvironmentStrings']('%userprofile%')+'\\Desktop');else s[1]=_Wss['ExpandEnvironmentStrings']('%'+s[1]+'%');pn=s.join('')};try{return String(_Fso['GetFile'](pn))}catch(e){};try{pn=String(_Fso['GetFolder'](pn));if(pn.substring(pn.length-1,pn.length)!=='\\')pn+='\\';return pn}catch(e){};return String(pn)},_Exist=function(pn){pn=_Env(pn);return(_Fso['FileExists'](pn)||_Fso['FolderExists'](pn))},_CreateFile=function(pn,text,ow,uc){pn=_Env(pn);if(_Exist(pn)&&((ow===undefined)?true:ow))_Fso['DeleteFile'](pn);if(!_Exist(pn)){let tf=_Fso['CreateTextFile'](pn,true,true);tf['WriteLine'](text);tf['Close']();if((uc===undefined)?true:!uc){_Wss['Run']('cmd.exe /c chcp 65001 & cmd.exe /c type "'+pn+'"> "'+pn+'.txt"',0,true);_Fso['DeleteFile'](pn);_Fso['MoveFile'](pn+".txt",pn)};return _Env(pn)}},_CreateFolder=function(pn,ow){pn=_Env(pn);if(pn[pn.length-1]==='\\')pn=pn.substring(0,pn.length-1);if(_Exist(pn)&&((ow===undefined)?true:ow))_Fso['DeleteFolder'](pn);if(!_Exist(pn))_Fso['CreateFolder'](pn);return _Env(pn)},_UnZip=function(zf,ef){zf=_Env(zf);ef=_Env(ef);function tk(){_TaskKill(['cmd.exe','mshta.exe'])};_Win.addEventListener('beforeunload',tk);try{zf=String(_Fso['GetFile'](zf))}catch(e){_Win.alert("obj.unZip()\n\nCannot find the ZIP file !\n\n"+zf);return''};if(_Fso['FolderExists'](ef))_Fso['DeleteFolder'](String(_Fso['GetFolder'](ef)));ef=String(_Fso['CreateFolder'](ef));_Sap['NameSpace'](ef)['CopyHere'](_Sap['NameSpace'](zf)['Items']());_Win.removeEventListener('beforeunload',tk);return _Env(ef)},_Download=function(dl,tgt){tgt=_Env(tgt);function tk(){_TaskKill(['powershell.exe','cmd.exe','mshta.exe'])};_Win.addEventListener('beforeunload',tk);_Wss['Run']('cmd.exe /c powershell -command (New-Object System.Net.WebClient).DownloadFile(\\"'+dl+'\\",\\"'+tgt+'\\")',0,true);_Win.removeEventListener('beforeunload',tk);return _Env(tgt)},_ReadInUnicode=function(pn){function tk(){_TaskKill(['cmd.exe','mshta.exe'])};_Win.addEventListener('beforeunload',tk);_Wss['Run']('cmd.exe /c chcp 65001 & cmd.exe /u /c type "'+pn+'"> "'+pn+'.uni"',0,true);let unicode_file=_Fso['OpenTextFile'](pn+'.uni',1,0,-1),text=unicode_file['ReadAll']();unicode_file['Close']();_Fso['DeleteFile'](pn+'.uni');_Win.removeEventListener('beforeunload',tk);return text},_ReadOnlineFile=function(link,func){try{let xhr=new XMLHttpRequest();xhr.open('GET',(link+'?_='+new Date().getTime()));xhr.responseType='text';xhr.addEventListener('load',function(){if((xhr.readyState===xhr.DONE)&&(xhr.status===200))func(xhr.responseText)});xhr.send(null)}catch(e){_OkMsg("404: Not Found!")}},_ReadOfflineFile=function(pn,func){pn=_Env(pn);if(_Exist(pn))return func(_ReadInUnicode(pn));_Win.alert((_Hun?"Ez a fájl nem található:":"This file could not be found:")+"\n\n'"+pn+"'")},_Operation=function(op){let a="obj."+op.cmd+"(",t_folder='';if(op.source===undefined)return _Win.alert(a+"source, ...)\n\nThe - source - parameter is missing !\n");if(_Find(op.cmd,/copy|move/)){if(op.overwrite===undefined)op.overwrite=true;if(op.target){t_folder=_Env(op.target);if(!_Fso['FolderExists'](t_folder))return _Win.alert(a+"source, target, overwrite)\n\nCannot find the target folder !\n\n"+op.target)}else return _Win.alert(a+"source, target, overwrite)\n\nThe - target - parameter is missing !\n")}else{if(op.target)return _Win.alert(a+"source, target, overwrite)\n\nExcept for copy and move,\n\nyou don't need the - target - parameter.\n");if(op.overwrite)return _Win.alert(a+"source, target, overwrite)\n\nExcept for copy and move,\n\nyou don't need the - overwrite - parameter.\n")};if(op.cmd==='rename'){if(typeof op.newname!=='string')return _Win.alert(a+"source, newname)\n\nThe - newname - parameter is missing !\n")}else if(op.newname)return _Win.alert(a+"source, newname)\n\nExcept for rename,\n\nyou don't need the - newname - parameter.\n");if(op.cmd==='visibility'){if(typeof op.visible!=='boolean')return _Win.alert(a+"source, visible)\n\nThe - visible - parameter is missing !\n\n•  true-false\n")}else if(op.visible)return _Win.alert(a+"source, visible)\n\nExcept for visibility,\n\nyou don't need the - visible - parameter.\n");function operat(s_object){let file=false;s_object=_Env(s_object);if(_Exist(s_object)){try{s_object=_Fso['GetFile'](s_object);file=true}catch(e){s_object=_Fso['GetFolder'](s_object)};s_object=String(s_object);if(_Find(op.cmd,/copy|move/)){let t_object=(t_folder+s_object.split("\\").pop());if(op.overwrite&&_Exist(t_object)){(file?_Fso['DeleteFile'](t_object):_Fso['DeleteFolder'](t_object))};if(!_Exist(t_object)){if(file){if(op.cmd==='copy')_Fso['CopyFile'](s_object,t_folder,true);if(op.cmd==='move')_Fso['MoveFile'](s_object,t_folder)}else{if(op.cmd==='copy')_Fso['CopyFolder'](s_object,t_folder,true);if(op.cmd==='move')_Fso['MoveFolder'](s_object,t_folder)}}};if(op.cmd==='del'){(file?_Fso['DeleteFile'](s_object):_Fso['DeleteFolder'](s_object))};if(op.cmd==='rename'){let s_folder=s_object.replace(s_object.split("\\").pop(),"");if(!_Exist(s_folder+op.newname))(file?_Fso['MoveFile'](s_object,s_folder+op.newname):_Fso['MoveFolder'](s_object,s_folder+op.newname))};if(op.cmd==='visibility'){(file?(_Fso['GetFile'](s_object).Attributes=(op.visible?0:2)):(_Fso['GetFolder'](s_object).Attributes=(op.visible?16:18)))}}};if(typeof op.source==='object'){if(op.cmd==='rename')return _Win.alert(a+")\n\nOnly one object can be renamed !");else _LoopIn(op.source,function(key,source){operat(source)})}else if(typeof op.source==='string')operat(op.source);else return _Win.alert(a+"source, ...)\n\nThe - source - parameter is missing !\n\n•  'pathname'\n•  ['pathname 1', 'pathname 2']")},_Copy=function(src,tgt,ow){_Operation({cmd:'copy',source:src,target:tgt,overwrite:ow})},_Move=function(src,tgt,ow){_Operation({cmd:'move',source:src,target:tgt,overwrite:ow})},_DelObject=function(src){_Operation({cmd:'del',source:src})},_Rename=function(src,nn){_Operation({cmd:'rename',source:src,newname:nn})},_Visibility=function(src,st){_Operation({cmd:'visibility',source:src,visible:st})},_Info=function(i){let info={'creator':'István Reich','created':'2017.02.15','version':'201102','updated':'2020.11.20'};return info[i]},_Freezing=function(ms){let t=new Date().getTime();while(true){if((t+ms)<new Date().getTime())break};return(new Date().getTime()-t)},_ActiveX=function(v){if(!_Find(v,/\b(wss|fso|sap)\b/)){_Win.alert("hta.activeX( )\n\nParameter is missing !\n\n•  'wss'\n•  'fso'\n•  'sap'\n");return''};return((v==='fso')?_Fso:(v==='wss')?_Wss:(v==='sap')?_Sap:{})},_PathName=function(m){if(!_Find(m,/\b(file|folder|full)\b/)){_Win.alert("hta.pathName( )\n\nParameter is missing !\n\n•  'file'\n•  'folder'\n•  'full'\n");return''};let pn=_Win.location.pathname;let hta_file=pn.split("\\").pop();if(pn[0]==="/")pn=pn.substring(1,pn.length);if(m==='file')return hta_file;if(m==='folder')return pn.replace(hta_file,'');if(m==='full')return pn},_FontSmoothing=function(bool){let tags=_Doc.getElementsByTagName('*'),shadow='1px 0px 0px rgba(100,100,100,0.1), -1px 0px 0px rgba(100,100,100,0.1), 0px 1px 0px rgba(100,100,100,0.1), 0px -1px 0px rgba(100,100,100,0.1)';_LoopIn(tags,function(key,tag){if(bool){if(_Find(tag.tagName,/BODY|INPUT|TEXTAREA/)&&(tag['currentStyle']['text-shadow']==='none'))tag.style.textShadow=shadow;if(_Find(tag.tagName,/SCRIPT|BR|IMG|OBJECT|PARAM/)||_Find(tag.className,/shl-logline|shl-touch/))tag.style.textShadow=''}else if(tag['currentStyle']['text-shadow']===shadow)tag.style.textShadow=''})},_RunReg=function(v,o){let regFile;try{regFile=String(_Fso['GetFile'](v))}catch(e){regFile=_CreateFile('%temp%\\shl-TempRegFile.reg',v.replace(/\t/g,''),true,true)}(o?_Wss['Run']('notepad.exe "'+regFile+'"',1,false):_Wss['Run']('cmd.exe /c regedit.exe /s "'+regFile+'"',0,true));return regFile},_RunCmd=function(v,s,o){let batFile;try{batFile=String(_Fso['GetFile'](v))}catch(e){batFile=_CreateFile('%temp%\\shl-TempBatFile.bat',v.replace(/\t/g,''),true)};if(s===undefined)s='';(o?_Wss['Run']('notepad.exe "'+batFile+'"',1,false):_Wss['Run']('cmd.exe /c "'+batFile+'" '+s,0,true));return batFile},_Update=function(ver,link){if(link)_ReadOnlineFile(link,function(text){let hta_path=_PathName('full'),lat=text.split('[SHL] - latest version: ')[1].split(';')[0],msg=text.split('[SHL] - notification message:\r\n')[1].split('\r\n[SHL] - end of message;')[0],ddl=text.split('[SHL] - direct download link: ')[1].split(';')[0],ext=text.split('[SHL] - downloaded file ext: ')[1].split(';')[0],web=text.split('[SHL] - open web page: ')[1].split(';')[0],opn=text.split('[SHL] - hta file re-open: ')[1].split(';')[0],txt=text.split('[SHL] - text of hta file:\r\n')[1].split('\r\n[SHL] - end of hta text;')[0];if(parseFloat(lat)<=ver)return;_OkMsg(msg,function(){_Doc.body.innerHTML+='<div class="shl-html-tags" style="position:absolute;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,0.4);z-index:99999"></div>';if(ddl!==''){let dl_file=_Env('%temp%\\shl-dl-file'+ext);_Download(ddl,dl_file);if(_Exist(dl_file))_Wss['Run']('"'+dl_file+'"',1,true);else _OkMsg((_Hun?'A letöltés nem sikerült!':'Download failed!'),false,'Ok')};if(web!=='')_Wss['Run']('cmd.exe /c start "" "'+web+'"');if(opn==='true')_Win.addEventListener('beforeunload',function(){_Wss['Run']('cmd.exe /c timeout /t 1 && start "" "'+hta_path+'"',0)});if(txt!=='')_CreateFile(hta_path,txt,true);_Win.close()},(_Hun?'Igen':'Yes'),false,(_Hun?'Később':'Later'),(link+'?_='+new Date().getTime()))});else link='';return[ver,link]},_AddItemsToSelector=function(selector,items,start){let s=_Doc.getElementById(selector),list=_Class('shl-list-for-'+selector),input=_Class('shl-input-for-'+selector),i=0,non=false;if(!s)return _Win.alert("hta.addItemsToSelector( id, ...)\n\n"+(_Hun?"Ez az id nem található:":"This id is not found:")+"\n\n'"+selector+"'");if(list==null)non=true;if(non){list=_Doc.createElement('div');list.className=('shl-html-tags shl-selector-lists shl-app-mode shl-list-for-'+selector);list.style.border=(s['currentStyle']['border-width']+' '+s['currentStyle']['border-style']+' '+s['currentStyle']['border-color']);list.style.borderRadius=s['currentStyle']['border-radius'];list.style.minWidth=(s.getBoundingClientRect().width+'px');input=_Doc.createElement('input');input.type='text';input.className=('shl-html-tags shl-inputs shl-input-for-'+selector);input.style.position='absolute';input.style.display='none'};list.innerHTML='';_LoopIn(items,function(key,html){html=html.replace(/[<>&]/g,'').replace(/\s+/g,' ');list.innerHTML+=('<div class="shl-list-items shl-app-mode shl-html-tags" id="'+selector+'-item-'+i+'">'+html+'</div');if((start||0)===i){input.value=key;s.innerHTML=html};i++});if(non){_Doc.body.appendChild(input);_Doc.body.appendChild(list)};_Selectors[selector]=items},_SetPowerTimeById=function(id){_PowerTime[id]=new Date().getTime()},_GetPowerTimeById=function(id){let t=_PowerTime[id];return(t?(new Date().getTime()-t):-1)},_MainPowerTime=function(){return(new Date().getTime()-_MPowerTime)},t=false,_LogDelButtonAlign=function(){let ta=_Class('shl-logline-textarea'),de=_Class('shl-logline-delete');de.style.right=((ta.offsetWidth-ta.clientWidth)+3)+'px';de.style.bottom=((ta.offsetHeight-ta.clientHeight)+3)+'px'},_LogAdd=function(text){if(arguments.length>0){_LoglineText+=(String(text)+"\n");if(_LoglineEnabled&&!t)t=setTimeout(function(){let ta=_Class('shl-logline-textarea'),txt='',arr=[];if(!ta)return;txt=_LoglineText.replace(/\t/g,'   ');arr=txt.split('\n');ta.value=((arr.length>_LogRows)?arr.slice(arr.length-(_LogRows+1),arr.length).join("\n"):txt);ta.scrollTop=ta.scrollHeight;_LogDelButtonAlign();t=false},15)};return _LoglineText},_LogClear=function(){_LoglineText='';_Class('shl-logline-textarea').value=_LoglineText;_LogDelButtonAlign()},_LogPause=function(){_Class('shl-logline-paused').style.display=(_LoglineEnabled?'inline-block':'none');_LoglineEnabled=!_LoglineEnabled},_Open=function(wo){if(!_Doc.body){_Win.alert("wnd.open( {} )\n\nUse this function in script tag in body !");_Win.close()};if(_Opened)return _Win.alert("Use the wnd.open( {} )\n\nfunction only once !");_Opened=true;if(typeof wo['title']!=='string'){_Win.alert("wnd.open( {} )\n\nThe - title: - parameter is missing !");_Win.close()};if(!wo['type']||!_Find(wo['type'],/\b(tool|fixed|default|max|full)\b/)){_Win.alert("wnd.open( {} )\n\nThe - type: - parameter is missing !\n\n•  'tool'\n•  'fixed'\n•  'default'\n•  'max'\n•  'full'\n");_Win.close()}else if(_Find(wo['type'],/tool|fixed/)){if(wo['caption']===undefined){_Win.alert("wnd.open( {} )\n\nThe - caption: - parameter is missing !\n\n•  true\n•  false\n•  'className'\n");_Win.close()}}else if(wo['type']==='default'){if(wo['caption']!==undefined)_Win.alert("wnd.open( {} )\n\nIf the window type is 'default' then\n - caption: - parameter is not required.\n");wo['caption']=true}else if((wo['caption']!==undefined)||wo['width']||wo['height']||wo['left']||wo['top']){_Win.alert("wnd.open( {} )\n\nIf the window type is 'max' or 'full' then\n\n•  caption:\n•  width:\n•  height:\n•  top:\n•  left:\n\nvalues are not required.\n")};if(wo['logline']&&(typeof wo['logline']!=='object')){_Win.alert("wnd.open( {} )\n\nWrong - logline: - parameter !\n\n•  ['bottom']\n•  ['right']\n•  ['bottom', 100]\n•  ['right', 100]\n");_Win.close()};let wnd_title=((wo['title'][0]==="!")?wo['title'].substring(1,wo['title'].length):wo['title']);let title_tag=_Doc.getElementsByTagName('title')[0];(title_tag?(title_tag.innerText=wnd_title):_Doc.head.innerHTML+=('<title>'+wnd_title+'</title>'));if(typeof wo['caption']==='string'){let cc=_Class(wo['caption']);if(!cc){_Win.alert("wnd.open( {} )\n\nCannot find the \"caption\" class !");_Win.close()}else if(wo['title'][0]!=="!")cc.innerHTML=wnd_title};let html='<object class="shl-html-tags shl-minimize-object" c\lassid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11" style="display: none;"><param name="command" class="shl-html-tags" value="minimize"></object>';html+='<object class="shl-html-tags shl-maximize-object" c\lassid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11" style="display: none;"><param name="command" class="shl-html-tags" value="maximize"></object>';if(wo['logline'])html+='<div class="shl-html-tags shl-logline-panel"><textarea class="shl-html-tags shl-logline-textarea" wrap="off" oncontextmenu="return false;" onfocus="this.blur()" readonly></textarea><div class="shl-html-tags shl-logline-paused">'+(_Hun?'Szünet':'Pause')+'</div><div class="shl-html-tags shl-logline-delete">'+(_Hun?'Törlés':'Delete')+'</div></div>';if(wo['fadein'])html+='<div class="shl-html-tags shl-fadein-layer"></div>';html+='<div class="shl-html-tags shl-msgbox-layer"><div class="shl-app-mode shl-html-tags shl-msgbox-dialog"><textarea wrap="off" class="shl-app-mode shl-html-tags shl-msgbox-textarea" onfocus="this.blur();" readonly></textarea><a href="#" class="shl-html-tags shl-msgbox-update-link" target="_blank" style="display:none;font-size:16px;" onmouseover="this.style.color=\'#36f\'" onmouseout="this.style.color=\'#999\'">'+(_Hun?'Részletek':'Details')+'</a><div class="shl-html-tags shl-msgbox-buttons-block" style="display:inline-block;white-space:nowrap;"><div class="shl-msgbox-buttons shl-app-mode shl-html-tags shl-msgbox-button-1"></div><div class="shl-msgbox-buttons shl-app-mode shl-html-tags shl-msgbox-button-2"></div></div></div></div>';html+='<div class="shl-touch-box shl-html-tags shl-touch-box-id"><div class="shl-touch-rect shl-touch-rect-fixed shl-html-tags shl-touch-rect-id"><div class="shl-touch-circle shl-html-tags shl-touch-circle-id"></div></div></div>';_Doc.body.innerHTML+=html.replace(/\t/g,'');_AddObservers();let light=true;try{light=(_Wss['RegRead']('HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize\\AppsUseLightTheme')==='1')}catch(e){};if(wo['inverse'])light=!light;_LoopIn(_Doc.getElementsByTagName('style'),function(key,tag){let css=tag.innerHTML.replace(/\t/g,'');if(_Find(css,/(\.shl-l-m|\.shl-d-m)\b/))tag.innerHTML=(light?css.replace(/\.shl-l-m\b/g,'.shl-app-mode'):css.replace(/\.shl-d-m\b/g,'.shl-app-mode'))});if(wo['type']==="full")_OuterSize=[_Win.screen.width,_Win.screen.height];else if(wo['type']==="max"){_Border[0]=(_Win.outerWidth-_Win.innerWidth);_Border[1]=(_Win.outerHeight-_Win.innerHeight);_OuterSize[0]=(_Win.screen.availWidth+_Border[0]);_OuterSize[1]=(_Win.screen.availHeight+_Border[0])}else if(_Find(wo['type'],/tool|fixed|default/)){if(wo['caption']===true){_Border[0]=(_Win.outerWidth-_Win.innerWidth);_Border[1]=(_Win.outerHeight-_Win.innerHeight)};if(wo['type']==='default'){try{let dt=_Wss['RegRead']('HKCU\\Software\\Shl\\WindowPosition\: '+wnd_title).split(' | '),size=dt[0].split('x'),offs=dt[1].split('x');wo['width']=parseInt(size[0]);wo['height']=parseInt(size[1]);wo['top']=parseInt(offs[0]);wo['left']=parseInt(offs[1])}catch(e){};_Win.addEventListener('beforeunload',function(){_Wss['RegWrite']('HKCU\\Software\\Shl\\WindowPosition\: '+wnd_title,_Win.innerWidth+'x'+_Win.innerHeight+' | '+_Win.screenY+'x'+_Win.screenX,'REG_SZ')})};wo['width']=_ConvertSize(wo['width'],'width');wo['height']=_ConvertSize(wo['height'],'height');if(wo['width']>_Win.screen.width)wo['width']=_Win.screen.width;if(wo['height']>_Win.screen.height)wo['height']=_Win.screen.height;_OuterSize[0]=(wo['width']+_Border[0]);_OuterSize[1]=(wo['height']+_Border[1]);_Offset[0]=Math.ceil((wo['left']!==undefined)?_ConvertSize(wo['left'],'width'):((_Win.screen.width/2)-(_OuterSize[0]/2)));_Offset[1]=Math.ceil((wo['top']!==undefined)?_ConvertSize(wo['top'],'height'):((_Win.screen.height/2)-(_OuterSize[1]/2)))};if(wo['logline']){let expanded=false,llp=_Class('shl-logline-panel'),llt=_Class('shl-logline-textarea'),lld=_Class('shl-logline-delete');llt.onclick=_LogPause;lld.onclick=_LogClear;_LogRows=(wo['logline'][1]?wo['logline'][1]:1000);if(wo['logline'][0]==='bottom'){llp.style.width='100%';llp.style.height='30px';llp.style.bottom='0px';llp.style[(wo['caption']===true)?'borderTop':'border']='2px solid #aaa'}else if(wo['logline'][0]==='right'){llp.style.width='30px';llp.style.height='100%';llp.style.right='0px';llp.style[(wo['caption']===true)?'borderLeft':'border']='2px solid #aaa'}else{_Win.alert("wnd.open( {} )\n\nWrong - logline: - parameter !\n\n•  ['bottom']\n•  ['right']\n•  ['bottom', 100]\n•  ['right', 100]\n");_Win.close()};_Win.addEventListener('mousemove',function(e){if(_CaptionClicked)return;if(_ClassGet(e.target,'shl-logline')){if(!expanded){llp=_Class('shl-logline-panel');llt=_Class('shl-logline-textarea');lld=_Class('shl-logline-delete');llt.style.overflow='auto';lld.style.display='inline-block';_Win.requestAnimationFrame(_LogDelButtonAlign);expanded=true};llp.style[(wo['logline'][0]==='bottom')?'height':'width']='calc(100% - 30px)'}else{llt.style.overflow='hidden';lld.style.display='none';llp.style[(wo['logline'][0]==='bottom')?'height':'width']='30px';expanded=false}})};_HTAtag.setAttribute('icon',(wo['icon']?wo['icon']:''));_HTAtag.setAttribute('id','shl-app-id-'+wnd_title.replace(/\s/g,'-'));_HTAtag.setAttribute('class','shl-html-tags');_HTAtag.setAttribute('applicationname',wnd_title);_HTAtag.setAttribute('singleinstance','yes');_HTAtag.setAttribute('innerborder','no');_HTAtag.setAttribute('scroll','no');_HTAtag.setAttribute('selection','no');function borderState(state){switch(state){case'fixed':_HTAtag.setAttribute('border','thin');break;case'hidden':_HTAtag.setAttribute('caption','no');_HTAtag.setAttribute('border','none')}};function windowState(state){switch(state){case'maximized':_HTAtag.setAttribute('windowstate','maximize');break;case'min-close':_HTAtag.setAttribute('border','thin');_HTAtag.setAttribute('maximizebutton','no');break;case'close':_HTAtag.setAttribute('border','thin');_HTAtag.setAttribute('maximizebutton','no');_HTAtag.setAttribute('minimizebutton','no')}};switch(wo['type']){case'tool':((wo['caption']===true)?windowState('close'):borderState('hidden'));break;case'fixed':((wo['caption']===true)?windowState('min-close'):borderState('hidden'));break;case'default':borderState('normal');windowState('normal');break;case'max':borderState('normal');windowState('maximized');break;case'full':borderState('hidden');windowState('maximized')};_Doc.head.appendChild(_HTAtag);function windowStarting(){_Win.focus();_Win.addEventListener('blur',function(){_HideSelectorLists()});_FontSmoothing((wo['fSmooth']===undefined)?true:wo['fSmooth']);if(_Find(wo['type'],/tool|fixed/)&&(typeof wo['caption']==='string')){let capBg,capC,posX=0,posY=0,cap=_Class(wo['caption']);cap.addEventListener('mouseup',function(){_CaptionClicked=false});cap.addEventListener('mousedown',function(){_CaptionClicked=true});_Win.addEventListener('mousemove',function(e){if(_CaptionClicked){_Offset[0]+=(e.pageX-posX);_Offset[0]=Math.ceil(_Offset[0]);_Offset[1]+=(e.pageY-posY);_Offset[1]=Math.ceil(_Offset[1]);_Win.moveTo(_Offset[0],_Offset[1])}else{posX=e.pageX;posY=e.pageY}});_Win.addEventListener('blur',function(){capBg=cap['currentStyle']["background-color"];capC=cap['currentStyle']["color"];cap.style.backgroundColor='#fff';cap.style.color='#aaa'});_Win.addEventListener('focus',function(){cap.style.backgroundColor=capBg;cap.style.color=capC})};_Doc.addEventListener('mousedown',function(cursor){if(cursor.button!==0)return;let button,parent3=cursor.target,parent2=parent3.parentElement,parent1=(parent2?parent2.parentElement:false);if(parent1&&_ClassGet(parent1,'shl-touch-buttons'))button=parent1;else if(parent2&&_ClassGet(parent2,'shl-touch-buttons'))button=parent2;else if(parent3&&_ClassGet(parent3,'shl-touch-buttons'))button=parent3;else return;if(_LastBtn!==button){_ClassSet(_LastBtn,'shl-touch-effect',false);_ClassSet(button,'shl-touch-effect',true);_LastBtn=button};clearTimeout(_TimerA);let pseudo=_Class('shl-pseudo-style-tag'),rect=button.getBoundingClientRect(),top=Math.ceil(cursor.pageY-rect.top),left=Math.ceil(cursor.pageX-rect.left),dur=500;pseudo.innerHTML='.shl-touch-effect::before{position:absolute;content:"";display:inline-block;width:20px;height:20px;top:'+top+'px;left:'+left+'px;opacity:1;border-radius:50%;transform:translate(-50%,-50%);transition-property:width, height, opacity;transition-duration:0ms;z-index:9999}';_Win.requestAnimationFrame(function(){pseudo.innerHTML=('.shl-touch-effect::before{position:absolute;content:"";display:inline-block;width:100px;height:100px;top:'+top+'px;left:'+left+'px;opacity:0;border-radius:50%;transform:translate(-50%,-50%);transition-property:width, height, opacity;transition-duration:'+dur+'ms;z-index:9999}');_TimerA=setTimeout(function(){pseudo.innerHTML='.shl-touch-effect::before{position:absolute;content:"";display:none}';clearTimeout(_TimerA)},dur)});let clickAttr=button.getAttribute('onclick'),delay=(_ClassGet(button,'shl-delay')?button.className.split('shl-delay-')[1].split('ms')[0]:'15');if(clickAttr!=='')button.onclick=function(){button.setAttribute('onclick','');_TimerB=setTimeout(function(){button.setAttribute('onclick',clickAttr);button.onclick();clearTimeout(_TimerB)},parseInt(delay))}});if(wo['fadein']){let opacity=1.0,mspf=(1000/60),rate=(mspf/wo['fadein'][0]),delay=wo['fadein'][1],fiLayer=_Class('shl-fadein-layer');fiLayer.style.opacity=opacity;if(wo['fadein'][0]<17)opacity=0;_DoOnFrame(function(frame){if((mspf*frame)<delay)return false;if(opacity>0)opacity-=rate;else{fiLayer.style.display='none';_IsReady=true};fiLayer.style.opacity=((opacity<0)?0:opacity);return _IsReady})}else _Win.requestAnimationFrame(function(){_IsReady=true})};let sizing=function(){};if(_Find(wo['type'],/tool|fixed|default/)){if(wo['caption']===true){_Win.resizeTo(_OuterSize[0],_OuterSize[1]);_Win.moveTo(_Offset[0],_Offset[1])}else{_Win.resizeTo(2,2);_Win.moveTo(0,0);_Wss['Run']('cmd.exe /c set "value=00000000000000000000000000000" && (for /f "tokens=3" %a in (\'reg query "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\StuckRects3" /v "Settings"\') do reg add "HKCU\\Software\\Shl" /v "TaskbarPosition" /t "REG_SZ" /d %a /f)',0,true);let tbpos;try{tbpos=_Wss['RegRead']('HKCU\\Software\\Shl\\TaskbarPosition')[25]}catch(e){tbpos='0'}(_Find('0 3',tbpos)?_Win.moveTo(0,_Win.screen.height-2):_Win.moveTo(_Win.screen.width-2,0));sizing=function(){_Win.resizeTo(_OuterSize[0],_OuterSize[1]);_Win.moveTo(_Offset[0],_Offset[1])}}};_Doc.addEventListener('DOMContentLoaded',function(){_DoOnFrame(function(){if((_Win.outerWidth===_OuterSize[0])&&(_Win.outerHeight===_OuterSize[1])){_IsOpen=true;return true};sizing();return false})});_Win.addEventListener('load',function(){_DoOnFrame(function(){if(_IsOpen){_Win.requestAnimationFrame(function(){_IsLoaded=true;windowStarting()});return true};return false})})},_OnOpen=function(func){_DoOnFrame(function(){if(_IsOpen){func();return true};return false})},_OnLoad=function(func){_DoOnFrame(function(){if(_IsLoaded){func();return true};return false})},_OnReady=function(func){_DoOnFrame(function(){if(_IsReady){func();return true};return false})},_OnFrame=function(func){let f=0;_DoOnFrame(function(){if(_IsOpen){func(f);f++};return false})},_OnTick=function(func){let t=0;setInterval(function(){if(_IsOpen){func(t);t++}},15)},_GetOffset=function(){if(_IsOpen)_Offset=[_Win.screenX,_Win.screenY];return _Offset.slice()},_SetOffset=function(x,y){if(arguments.length===0){x=((_Win.screen.width/2)-(_OuterSize[0]/2));y=((_Win.screen.height/2)-(_OuterSize[1]/2))}else if(typeof x==='object'){y=(x[1]?x[1]:0);x=(x[0]?x[0]:0)}else if(!y)y='0px';x=_ConvertSize(x,'width');y=_ConvertSize(y,'height');_Offset[0]=Math.ceil(x);_Offset[1]=Math.ceil(y);_Win.moveTo(_Offset[0],_Offset[1])},_GetSize=function(){if(_IsOpen)_OuterSize=[_Win.outerWidth,_Win.outerHeight];return[_OuterSize[0]-_Border[0],_OuterSize[1]-_Border[1]]},_SetSize=function(x,y,c){if(arguments.length===0)return _Win.alert("wnd.setSize()\n\nParameter is missing !\n\n•  array | number");if(typeof x==='object'){y=(x[1]?x[1]:0);x=(x[0]?x[0]:0)}else if(!y)y='0px';x=_ConvertSize(x,'width');y=_ConvertSize(y,'height');if(x>_Win.screen.width)x=_Win.screen.width;if(y>_Win.screen.height)y=_Win.screen.height;x+=_Border[0];y+=_Border[1];_OuterSize[0]=Math.ceil(x);_OuterSize[1]=Math.ceil(y);_Win.resizeTo(_OuterSize[0],_OuterSize[1]);if((c===undefined)?true:c)_SetOffset()},_BorderSize=function(v){return(v?((v==='lrb')?(_Border[0]/2):((v==='top')?(_Border[1]-(_Border[0]/2)):0)):_Border.slice())},_Cmd=function(cmd){if((!cmd)||!_Find(cmd,/\b(min|max|close)\b/))return _Win.alert("wnd.cmd(cmd)\n\nThe - cmd - parameter is missing !\n\n•  'min'\n•  'max'\n•  'close'\n");if((cmd==='min')&&(_HTAtag.getAttribute('minimizebutton')!=="no"))_Class('shl-minimize-object')['Click']();if((cmd==='max')&&(_HTAtag.getAttribute('maximizebutton')!=="no"))_Class('shl-maximize-object')['Click']();if(cmd==='close')_Win.close()},_DpiFactor=function(){let dpi;try{dpi=(Math.ceil(_Wss['RegRead']('HKCU\\Control Panel\\Desktop\\LogPixels'))/96)}catch(e){dpi=1.0};return dpi},_DelPos=function(t){try{_Wss['RegDelete']('HKCU\\Software\\Shl\\WindowPosition\: '+t)}catch(e){}};if(_X64()){let syswow64=_Env('%SystemRoot%\\Sysnative\\cmd.exe');if(_Exist(syswow64)){_Open=function(w){};_OnOpen=function(f){};_Win.resizeTo(100,100);_Win.moveTo(-300,-300);_Wss['Run'](syswow64+' /c (timeout /t 1) && ('+_Env('%SystemRoot%\\System32\\mshta.exe')+' "'+_PathName('full')+'")',0,false);_Win.close()}else if(!_Find(_Wss['RegRead']('HKCR\\htafile\\Shell\\Open\\Command\\'),'System32')){let admin,msg=((_Hun?'A .hta fájlt "System32\\mshta.exe"-vel kell megnyitni!\nJelenleg "SysWow64\\mshta.exe" nyitja meg.\n\nSzeretnéd ezt felülírni a Registry-ben?':'The .hta file must be opened with "System32\\mshta.exe"!\nDefault open command is "SysWow64\\mshta.exe".\n\nDo you want to overwrite this in the Registry?')+'\n\n(HKCR\\htafile\\Shell\\Open\\Command)'),reg=('Windows Registry Editor Version 5.00\r\n\r\n[HKEY_CLASSES_ROOT\\htafile\\Shell\\Open\\Command]\r\n@="'+_Env('%SystemRoot%\\System32\\mshta.exe').replace(/\\/g,'\\\\')+' \\"%1\\""');try{admin=(_Wss['RegRead']('HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableLUA')===0)}catch(e){admin=false};if(!admin)_ConfirmMsg(msg,function(){_RunReg(reg);_Win.alert(_Hun?'Kész!':'Done!')},(_Hun?'Igen':'Yes'),false,(_Hun?'Később':'Later'));else _RunReg(reg)}};_Doc.addEventListener('keydown',function(e){if(e.key==='F1')_OkMsg((_Hun?"Shl legutóbbi frissítése:\n":"Shl latest update:\n")+_Info('updated')+"\n\n"+(_Hun?"Verzió:\n":"Version:\n")+_Info('version'))});_Doc.write('<link rel="stylesheet" type="text/css" href="https://rawgit.com/re-is/shl/master/shl.'+_Info('version')+'.css?_='+(new Date().getTime())+'" class="shl-html-tags">');_Doc.write('<style type="text/css" class="shl-html-tags shl-pseudo-style-tag"></style>');_Win.SuperHtaLibrary=function(){this['msg']={ok:_OkMsg,confirm:_ConfirmMsg};this['obj']={taskkill:_TaskKill,env:_Env,exist:_Exist,createFile:_CreateFile,createFolder:_CreateFolder,unZip:_UnZip,download:_Download,readOnlineFile:_ReadOnlineFile,readOfflineFile:_ReadOfflineFile,copy:_Copy,move:_Move,del:_DelObject,rename:_Rename,visibility:_Visibility};this['hta']={find:_Find,loopIn:_LoopIn,loopPlus:_LoopPlus,loopMinus:_LoopMinus,info:_Info,freezing:_Freezing,activeX:_ActiveX,x64:_X64,pathName:_PathName,fontSmoothing:_FontSmoothing,runReg:_RunReg,runCmd:_RunCmd,update:_Update,addItemsToSelector:_AddItemsToSelector,hideSelectorLists:_HideSelectorLists,setPowerTimeById:_SetPowerTimeById,getPowerTimeById:_GetPowerTimeById,mainPowerTime:_MainPowerTime};this['log']={add:_LogAdd,clear:_LogClear,pause:_LogPause};this['wnd']={open:_Open,onOpen:_OnOpen,onLoad:_OnLoad,onReady:_OnReady,onFrame:_OnFrame,onTick:_OnTick,getOffset:_GetOffset,setOffset:_SetOffset,getSize:_GetSize,setSize:_SetSize,border:_BorderSize,cmd:_Cmd,dpiFactor:_DpiFactor,delPos:_DelPos};this['elemByClass']=_Class;this['inputByLabelId']=function(i){return(_Class('shl-input-for-'+i)||{})}}})(window,window.document);
